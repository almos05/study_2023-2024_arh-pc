---
## Front matter
title: "Отчёт по лабораторной работе №7"
subtitle: "дисциплина: Архитектура вычислительных систем"
author: "Мосолов Александр Денисович"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

<p>Изучение команд условного и безусловного переходов. Приобретение навыков написания программ с использованием переходов. Знакомство с назначением и структурой файла листинга.</p>

# Выполнение лабораторной работы

## Реализация переходов в NASM

<p>Создаём каталог для программ лабораторной работы № 7, переходим в него и
создаём файл *lab7-1.asm*.</p>

![Создаем каталог для работы](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-23 18-14-11.png){#fig:001 width=70%}

<p>Инструкция *jmp* в *NASM* используется для реализации безусловных переходов. Рассмотрим пример программы с использованием инструкции *jmp*. Введите в файл *lab7-1.asm* текст программы из листинга *7.1*.</p>

![Текст программы в соттветствии с листингом 7.1](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-23 18-28-38.png){#fig:002 width=70%}

<p>Для того, чтобы программа транслировалась без ошибок перенесем файл *in_out.asm* в *~/work/arch-pc/lab06*.</p>
<p>Создадим исполняемый файл и запустим его. Результат работы данной программы будет следующим:</p>

![Вывод программы из листинга 7.1](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-23 18-30-12.png){#fig:003 width=70%}

<p>Таким образом, использование инструкции *jmp _label2* меняет порядок исполнения инструкций и позволяет выполнить инструкции начиная с метки *_label2*, пропустив вывод первого сообщения. 
<p>Инструкция *jmp* позволяет осуществлять переходы не только вперед но и назад. Изменим программу таким образом, чтобы она выводила сначала *‘Сообщение № 2’*, потом *‘Сообщение № 1’* и завершала работу. Для этого в текст программы после вывода сообщения *№ 2* добавим инструкцию *jmp* с меткой *_label1* (т.е. переход к инструкциям вывода сообщения № 1) и после вывода сообщения *№ 1* добавим инструкцию *jmp* с меткой *_end* (т.е. переход к инструкции *call quit*). Изменим текст программы в соответствии с листингом *7.2*</p>

![Текст программы в соответствии с листингом 7.2](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-23 18-49-31.png){#fig:004 width=70%}

<p>Создадим исполняемый файл и проверим его работу.</p>

![Вывод программы из листинга 7.2](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-23 18-50-01.png){#fig:005 width=70%}

<p>Изменим текст программы добавив или изменив инструкции *jmp*, чтобы вывод программы был следующим:</p>
<p>*Сообщение № 3*</p>
<p>*Сообщение № 2*</p>
<p>*Сообщение № 1*</p>

![Текст программы lab7-1](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-23 18-51-35.png){#fig:006 width=70%}

<p>Транслируем текст, создаём объектный файл, компилируем его и запускаем программу *lab7-1*:</p>
<p>*nasm -f elf lab7-1.asm*</p>
<p>*ld -m elf_i386 -o lab7-1 lab7-1.o*</p>
<p>*./lab7-1*</p>

![Вывод программы lab7-1](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-23 18-51-55.png){#fig:007 width=70%}

<p>Создаём файл *lab7-2.asm* в каталоге *~/work/arch-pc/lab07*. Изучаем текст программы из листинга *7.3* и вводим его в *lab7-2.asm.*</p>

![Текст программы из листинга 7.3](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-23 19-40-56.png){#fig:008 width=70%}

<p>Создаём исполняемый файл и проверяем его работу для разных значений *B*. Проверим работу программы для чисел: *1, 50, 21, 100, 20*.</p>

![Проверяем работу программы из листинга 7.3](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-23 19-42-14.png){#fig:009 width=70%}

## Изучение структуры файлы листинга

 <p>Обычно nasm создаёт в результате ассемблирования только объектный файл. Получить файл листинга можно, указав ключ *-l* и задав имя файла листинга в командной строке. Создаём файл листинга для программы из файла *lab7-2.asm*. Вводим команду:</p>
<p>*nasm -f elf -l lab7-2.lst lab7-2.asm*</p>

![Файл листинга lab7-2.lst](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-23 19-43-59.png){#fig:010 width=70%}

<p>Откроем файл листинга *lab7-2.lst* с помощью текстового редактора *nano*.</p>
<p>Задание: внимательно ознакомиться с форматом листинга и содержимым. Подробно объяснить содержимое трёх строк файла листинга по выбору.</p>
<p>Строка 34: 0000001D - адрес в сегменте кода, BB01000000 - машинный код, mov ebx, 1 - присвоение ebx значение 1</p>
<p>Строка 35: 00000022 - адрес в сегменте кода, B804000000 - машинный код, mov eax, 4 - присвоение eax значение 1</p>
<p>Строка 34: 00000027 - адрес в сегменте кода, CD80 - машинный код, int 80h - обращение к ядру</p>

![Текст файла листинга 7.3](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-24 14-19-48.png){#fig:011 width=70%}

<p>А теперь на вывод программы с использованием *iprint*.</p>

![Используем iprint](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/Снимок экрана от 2023-11-16 15-55-41.png){#fig:012 width=70%}

<p>Задание: откройте файл с программой *lab7-2.asm* и в любой инструкции с двумя операндами удалить один операнд. Выполните трансляцию с получением файла листинга.</p>
<p>Проверим файл изначального листинга.</p>

![Листинг lab7-2.lst](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-24 14-14-52.png){#fig:013 width=70%}

<p>Уберём из него один операнд - *B* в 17 строке. Посмотрим файл листинга после повторного получения.</p>

![Текст листинга после удаления из текста программы операнда B](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-23 21-34-31.png){#fig:014 width=70%}

<p>В листинге добавляется текст, сообщающий об ошибке. Выходные данные: текст об ошибке компиляции.</p>

## Задание для самостоятельной работы

<p>Напишите программу нахождения наименьшей из *3* целочисленных переменных *a, b, c*. Значения переменных выбрать из табл. *7.5* в соответствии с вариантом, полученным при выполнении лабораторной работы *№ 6*. Создайте исполняемый файл и проверьте его работу.</p>
<p>В моём случае вариант *9* - сравниние чисел *15, 24, 98*.</p>
<p>Запишем текст программы в *lab7-2.asm*</p>

![Текст программы нахождения наименьшего из трёх чисел](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-24 03-09-06.png){#fig:015 width=70%}

<p>Проверим программу на работоспособность. Транслируем полученный текст программы *lab7-2.asm* в объектный файл. Выполняем компоновку объектного файла и запускаем получившийся исполняемый файл.</p>

![Результат работы программы поиска наименьшего из трёх чисел](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-24 03-10-01.png){#fig:016 width=70%}

<p>Транслируем полученный текст программы *lab6-3.asm* в объектный файл. Выполняем компоновку объектного файла и запускаем получившийся исполняемый файл.</p>

![Результат запуска изменённого файла lab6-3](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab06/report/image/Снимок экрана от 2023-11-16 16-05-19.png){#fig:017 width=70%}

<p>Напишите программу, которая для введенных с клавиатуры значений *x* и *a* вычисляетзначение заданной функции *f(x)* и выводит результат вычислений. Вид функции *f(x)* выбрать из таблицы *7.6* вариантов заданий в соответствии с вариантом, полученным при выполнении лабораторной работы *№ 6*. Создайте исполняемый файл и проверьте его работу для значений *x* и *a* из *7.6*.</p>

 <p>Создадим файл *lab7.asm*, напишем текст программы.</p>
 
![Текст программы для вычисления *f(x)*](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-24 19-04-26.png){#fig:018 width=70%}

<p>Транслируем текст программы *lab7.asm* в объектный файл. Выполняем компоновку объектного файла и запускаем получившийся исполняемый файл.</p>

![Результат работы программы по вычислению *f(x)*](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-24 19-03-12.png){#fig:019 width=70%}

<p>Проверим работу программы подставив *a=5*, *x=7* и *a=6*, *x=4*.</p>

![Проверка программы для a и x из таблицы](/home/admosolov/work/study/2023-2024/Архитектура компьютера/arch-pc/labs/lab07/report/image/Снимок экрана от 2023-11-24 19-17-21.png){#fig:020 width=70%}

# Выводы

<p>В ходе лабораторной работы были изучены команды условного и безусловного переходов. Приобретены навыки написания программ с использованием переходов. Помимо этого, была усвоена информация, связанная с назначением и структурой файла листинга.</p>
